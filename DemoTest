local WindUI = loadstring(game:HttpGet("https://github.com/Footagesus/WindUI/releases/latest/download/main.lua"))()

-- =========================
-- Window UI
-- =========================
local Window = WindUI:CreateWindow({
    Title = "ERROR HUB | Free | [ Demo ]",
    Icon = "",
    Author = "",
    Folder = "ERROR HUB",
    Size = UDim2.fromOffset(450, 330),
    Theme = "Dark",
    Transparent = true,
    Resizable = true,
})



local MainTab = Window:Tab({Title = "COMBAT", Icon = "crosshair"})
-- Auto Pick Item System
local Players = game:GetService("Players")
local player = Players.LocalPlayer
local dropfolder = workspace:WaitForChild("DroppedItems")
local RunService = game:GetService("RunService")

local function GetDistanceFromRootPart(target)
    if not target then
        return math.huge
    end
    local char = player.Character or player.CharacterAdded:Wait()
    local root = char:FindFirstChild("HumanoidRootPart")
    if not root then
        return math.huge
    end
    return (root.Position - target.Position).Magnitude
end

_G.AutoPickItems = false

task.spawn(
    function()
        while task.wait(0) do
            if _G.AutoPickItems then
                for _, v in pairs(dropfolder:GetChildren()) do
                    if v and not v:GetAttribute("Locked") then
                        local zone = v:FindFirstChild("PickUpZone")
                        if zone then
                            local dist = GetDistanceFromRootPart(zone)
                            if dist < math.huge then
                                Net.get("pickup_dropped_item", v)
                            end
                        end
                    end
                end
            end
        end
    end
)

MainTab:Toggle(
    {
        Title = "Auto Pick Item",
        Flag = "Pickitem",
        Desc = "Pick up items that are far away",
        Icon = "check",
        Type = "Checkbox",
        Value = false,
        Callback = function(value)
            _G.AutoPickItems = value
        end
    }
)

-- Drop Item Viewer System
local item_drawings = {}
local RunService = game:GetService("RunService")
local CurrentCamera = workspace.CurrentCamera
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "DropItemViewerGui"
screenGui.ResetOnSpawn = false
screenGui.IgnoreGuiInset = true
screenGui.Parent = PlayerGui

VisualTab:Toggle(
    {
        Title = "Drop Item Viewer",
        Flag = "dropitem_viewer",
        Icon = "check",
        Type = "Checkbox",
        Default = true,
        Callback = function(state)
            c().EnabledItemDrop = state
        end
    }
)

local function getItemImageId(itemName)
    if itemName == "Money" then
        local success, moneyModel = pcall(function()
            return LocalPlayer.PlayerGui.TopRightHud.Holder.Frame.Frame.MoneyViewport.MoneyModel
        end)
        
        if success and moneyModel then
            return moneyModel
        end
    end
    
    local Items = ReplicatedStorage:FindFirstChild("Items")
    if not Items then
        return nil
    end
    
    for _, category in ipairs(Items:GetChildren()) do
        if category:IsA("Folder") then
            local itemData = category:FindFirstChild(itemName)
            if itemData then
                local imageId = itemData:GetAttribute("ImageId")
                if imageId then
                    return imageId
                end
                
                for _, attrName in ipairs({"Image", "Icon", "TextureId", "Texture"}) do
                    local attr = itemData:GetAttribute(attrName)
                    if attr then
                        return attr
                    end
                end
            end
        end
    end
    
    return nil
end

local function formatImageId(imageId)
    if not imageId or imageId == "" then
        return nil
    end
    return imageId
end

RunService.RenderStepped:Connect(
    function()
        if not c().EnabledItemDrop then
            for _, d in pairs(item_drawings) do
                if d.shadowFrame then
                    d.shadowFrame.Visible = false
                end
                if d.imageFrame then
                    d.imageFrame.Visible = false
                end
                if d.nameShadow then
                    d.nameShadow.Visible = false
                end
                if d.name then
                    d.name.Visible = false
                end
                if d.distShadow then
                    d.distShadow.Visible = false
                end
                if d.dist then
                    d.dist.Visible = false
                end
            end
            return
        end

        local Dropped = workspace:FindFirstChild("DroppedItems")
        if not Dropped then
            return
        end

        for item, d in pairs(item_drawings) do
            if not item or not item.Parent then
                if d.shadowFrame then
                    d.shadowFrame:Destroy()
                end
                if d.imageFrame then
                    d.imageFrame:Destroy()
                end
                if d.nameShadow then
                    d.nameShadow:Remove()
                end
                if d.name then
                    d.name:Remove()
                end
                if d.distShadow then
                    d.distShadow:Remove()
                end
                if d.dist then
                    d.dist:Remove()
                end
                item_drawings[item] = nil
            end
        end

        local nearbyItems = {}
        for _, item in ipairs(Dropped:GetChildren()) do
            if item:IsA("Model") and item:FindFirstChild("PickUpZone") and not item:GetAttribute("Locked") then
                local dist = (CurrentCamera.CFrame.Position - item.PickUpZone.Position).Magnitude
                table.insert(nearbyItems, {item = item, dist = dist})
            end
        end

        table.sort(
            nearbyItems,
            function(a, b)
                return a.dist < b.dist
            end
        )

        local IMAGE_SIZE = 60

        for i = 1, math.min(20, #nearbyItems) do
            local item = nearbyItems[i].item
            local d = item_drawings[item]

            if not d then
                d = {
                    nameShadow = Drawing.new("Text"),
                    name = Drawing.new("Text"),
                    distShadow = Drawing.new("Text"),
                    dist = Drawing.new("Text")
                }

                local shadowFrame = Instance.new("Frame")
                shadowFrame.Name = "ShadowFrame"
                shadowFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
                shadowFrame.BackgroundTransparency = 0.5
                shadowFrame.Size = UDim2.new(0, IMAGE_SIZE + 8, 0, IMAGE_SIZE + 8)
                shadowFrame.AnchorPoint = Vector2.new(0.5, 0.5)
                shadowFrame.BorderSizePixel = 0
                shadowFrame.Parent = screenGui
                
                local shadowCorner = Instance.new("UICorner")
                shadowCorner.CornerRadius = UDim.new(0, 10)
                shadowCorner.Parent = shadowFrame
                
                d.shadowFrame = shadowFrame

                local imageFrame = Instance.new("ImageLabel")
                imageFrame.Name = "ItemImage_" .. item.Name
                imageFrame.BackgroundTransparency = 1
                imageFrame.Size = UDim2.new(0, IMAGE_SIZE, 0, IMAGE_SIZE)
                imageFrame.AnchorPoint = Vector2.new(0.5, 0.5)
                imageFrame.ScaleType = Enum.ScaleType.Fit
                imageFrame.Parent = screenGui
                
                local rawImageId = getItemImageId(item.Name)
                
                if item.Name == "Money" and typeof(rawImageId) == "Instance" and rawImageId:IsA("Model") then
                    imageFrame:Destroy()
                    
                    local viewportFrame = Instance.new("ViewportFrame")
                    viewportFrame.Name = "MoneyViewport_" .. item.Name
                    viewportFrame.BackgroundTransparency = 1
                    viewportFrame.Size = UDim2.new(0, IMAGE_SIZE, 0, IMAGE_SIZE)
                    viewportFrame.AnchorPoint = Vector2.new(0.5, 0.5)
                    viewportFrame.Parent = screenGui
                    
                    local moneyClone = rawImageId:Clone()
                    moneyClone.Parent = viewportFrame
                    
                    local camera = Instance.new("Camera")
                    camera.Parent = viewportFrame
                    viewportFrame.CurrentCamera = camera
                    
                    local modelCF = moneyClone:GetBoundingBox()
                    camera.CFrame = modelCF * CFrame.new(0, 0, 3)
                    camera.Focus = modelCF
                    
                    imageFrame = viewportFrame
                else
                    local imageId = formatImageId(rawImageId)
                    if imageId then
                        imageFrame.Image = imageId
                    else
                        imageFrame.BackgroundTransparency = 0.3
                        imageFrame.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
                        
                        local corner = Instance.new("UICorner")
                        corner.CornerRadius = UDim.new(0, 8)
                        corner.Parent = imageFrame
                    end
                }
                
                d.imageFrame = imageFrame

                d.nameShadow.Color = Color3.new(0, 0, 0)
                d.nameShadow.Transparency = 0.5
                d.nameShadow.Outline = false
                d.nameShadow.Center = true
                d.nameShadow.Size = 16
                d.nameShadow.Font = 2

                d.name.Color = Color3.new(1, 1, 1)
                d.name.Outline = true
                d.name.Center = true
                d.name.Size = 16
                d.name.Font = 2

                d.distShadow.Color = Color3.new(0, 0, 0)
                d.distShadow.Transparency = 0.5
                d.distShadow.Outline = false
                d.distShadow.Center = true
                d.distShadow.Size = 14
                d.distShadow.Font = 2

                d.dist.Color = Color3.new(1, 1, 1)
                d.dist.Outline = true
                d.dist.Center = true
                d.dist.Size = 14
                d.dist.Font = 2

                item_drawings[item] = d
            end

            local pos, onScreen = CurrentCamera:WorldToViewportPoint(item.PickUpZone.Position)

            if onScreen then
                local halfSize = IMAGE_SIZE / 2

                local centerX = pos.X
                local centerY = pos.Y

                local time = tick() * 1.5
                local hue1 = (time % 6) / 6
                local hue3 = ((time + 3) % 6) / 6

                local color1 = Color3.fromHSV(hue1, 0.9, 1)
                local color3 = Color3.fromHSV(hue3, 0.7, 1)

                d.shadowFrame.Position = UDim2.new(0, centerX + 3, 0, centerY + 3)
                d.shadowFrame.Visible = true

                d.imageFrame.Position = UDim2.new(0, centerX, 0, centerY)
                d.imageFrame.Visible = true

                local nameY = centerY - halfSize - 25

                d.nameShadow.Text = item.Name
                d.nameShadow.Position = Vector2.new(centerX + 2, nameY + 2)
                d.nameShadow.Visible = true

                d.name.Text = item.Name
                d.name.Color = Color3.fromHSV(hue1, 0.6, 1)
                d.name.Position = Vector2.new(centerX, nameY)
                d.name.Visible = true

                local amount = item:FindFirstChild("AmountBillboardGui")
                amount = amount and amount:FindFirstChild("TextLabel") and amount.TextLabel.Text or "?"
                local amountText = "[ " .. amount .. " ]"

                local distY = centerY + halfSize + 10

                d.distShadow.Text = amountText
                d.distShadow.Position = Vector2.new(centerX + 2, distY + 2)
                d.distShadow.Visible = true

                d.dist.Text = amountText
                d.dist.Color = color3
                d.dist.Position = Vector2.new(centerX, distY)
                d.dist.Visible = true
            else
                if d.shadowFrame then
                    d.shadowFrame.Visible = false
                end
                if d.imageFrame then
                    d.imageFrame.Visible = false
                end
                d.nameShadow.Visible = false
                d.name.Visible = false
                d.distShadow.Visible = false
                d.dist.Visible = false
            end
        end
    end
)
